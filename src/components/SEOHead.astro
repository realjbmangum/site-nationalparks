---
import siteConfig from '../data/site-config.json';

interface Props {
  title?: string;
  description?: string;
  image?: string;
  canonicalUrl?: string;
  type?: 'website' | 'article';
  schema?: object;
}

const {
  title,
  description = siteConfig.seo.defaultDescription,
  image = '/og-image.jpg',
  canonicalUrl,
  type = 'website',
  schema,
} = Astro.props;

const pageTitle = title
  ? siteConfig.seo.titleTemplate.replace('%s', title)
  : siteConfig.seo.defaultTitle;

const url = canonicalUrl || Astro.url.href;
const imageUrl = new URL(image, siteConfig.url).href;

// Default schema for the site
const defaultSchema = {
  '@context': 'https://schema.org',
  '@type': 'WebSite',
  name: siteConfig.name,
  url: siteConfig.url,
  description: siteConfig.description,
  potentialAction: {
    '@type': 'SearchAction',
    target: `${siteConfig.url}/search?q={search_term_string}`,
    'query-input': 'required name=search_term_string',
  },
};
---

<!-- Primary Meta Tags -->
<title>{pageTitle}</title>
<meta name="title" content={pageTitle} />
<meta name="description" content={description} />
<link rel="canonical" href={url} />

<!-- Open Graph / Facebook -->
<meta property="og:type" content={type} />
<meta property="og:url" content={url} />
<meta property="og:title" content={pageTitle} />
<meta property="og:description" content={description} />
<meta property="og:image" content={imageUrl} />
<meta property="og:site_name" content={siteConfig.name} />

<!-- Twitter -->
<meta property="twitter:card" content="summary_large_image" />
<meta property="twitter:url" content={url} />
<meta property="twitter:title" content={pageTitle} />
<meta property="twitter:description" content={description} />
<meta property="twitter:image" content={imageUrl} />

<!-- Schema.org -->
<script type="application/ld+json" set:html={JSON.stringify(schema || defaultSchema)} />
